<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vicky's 2025 WNBA Playoff Picks Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ff6b35, #1a1a1a);
            color: white;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.85);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin: 0;
            color: #ff6b35;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .header p {
            font-size: 1.2em;
            margin: 10px 0;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 5px;
        }

        .nav-tab {
            background: transparent;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 5px;
            transition: all 0.3s ease;
        }

        .nav-tab.active {
            background: #ff6b35;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .nav-tab:hover {
            background: rgba(255, 107, 53, 0.7);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .instructions {
            background: rgba(255, 255, 255, 0.08);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #ff6b35;
        }

        .scoring-info {
            background: rgba(255, 107, 53, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 107, 53, 0.3);
        }

        .scoring-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .score-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .participant-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .participant-info input {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 16px;
            margin-top: 8px;
        }

        .bracket-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .round-section {
            background: rgba(255, 107, 53, 0.1);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid rgba(255, 107, 53, 0.5);
        }

        .round-title {
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: #ff6b35;
            font-size: 1.1em;
            background: rgba(255, 107, 53, 0.2);
            padding: 10px;
            border-radius: 8px;
        }

        .matchup {
            margin-bottom: 18px;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
        }

        .matchup label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #ffb347;
        }

        .matchup select {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 6px;
            background: white;
            color: #333;
            font-size: 15px;
            border: 2px solid transparent;
            transition: border-color 0.3s ease;
        }

        .matchup select:focus {
            outline: none;
            border-color: #ff6b35;
        }

        .finals-section {
            grid-column: 1 / -1;
            text-align: center;
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.15), rgba(255, 140, 66, 0.15));
            border: 2px solid #ff6b35;
        }

        .finals-section select {
            max-width: 350px;
            font-size: 16px;
            padding: 15px;
        }

        .submit-section {
            text-align: center;
            margin-top: 30px;
        }

        .submit-btn {
            background: linear-gradient(45deg, #ff6b35, #ff8c42);
            color: white;
            padding: 18px 45px;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.5);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .results-display {
            margin-top: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            display: none;
            border: 1px solid rgba(255, 107, 53, 0.3);
        }

        .results-display.success {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .results-display.error {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.1);
        }

        .dashboard {
            overflow-x: auto;
        }

        .dashboard-table {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }

        .dashboard-table th,
        .dashboard-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dashboard-table th {
            background: rgba(255, 107, 53, 0.3);
            font-weight: bold;
            color: #ff6b35;
        }

        .dashboard-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #ff6b35;
        }

        .status-message {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
        }

        .status-success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
            color: #4CAF50;
        }

        .status-error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
            color: #f44336;
        }

        .admin-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .refresh-btn {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }

        .refresh-btn:hover {
            background: #45a049;
        }

        @media (max-width: 768px) {
            .bracket-section {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .container {
                padding: 15px;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÄ Vicky's 2025 WNBA PLAYOFFS GAME</h1>
            <p>Just for fun & bragging rights! ‚Ä¢ Games Start September 14th</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('bracket')">Make Picks</button>
            <button class="nav-tab" onclick="showTab('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="showTab('admin')">Admin</button>
        </div>

        <!-- BRACKET TAB -->
        <div id="bracket" class="tab-content active">
            <div class="instructions">
                <h3>üìã Instructions & Scoring</h3>
                <p>Fill out your picks for each round. Submit before games begin on September 14th!</p>
            </div>

            <div class="scoring-info">
                <h4>üéØ Scoring System</h4>
                <div class="scoring-breakdown">
                    <div class="score-item">
                        <strong>First Round</strong><br>
                        1 point per correct pick<br>
                        (4 points max)
                    </div>
                    <div class="score-item">
                        <strong>Semifinals</strong><br>
                        2 points per correct pick<br>
                        (4 points max)
                    </div>
                    <div class="score-item">
                        <strong>Finals</strong><br>
                        4 points for champion<br>
                        (4 points max)
                    </div>
                    <div class="score-item">
                        <strong>Perfect Bracket</strong><br>
                        12 points total<br>
                        üèÜ Winner takes all!
                    </div>
                </div>
            </div>
            
            <form id="bracketForm">
                <div class="participant-info">
                    <label for="participantName"><strong>Your Name:</strong></label>
                    <input type="text" id="participantName" name="participantName" required placeholder="Enter your full name">
                </div>
                
                <div class="bracket-section">
                    <!-- Left Side First Round -->
                    <div class="round-section">
                        <div class="round-title">FIRST ROUND - LEFT SIDE<br>(Best of 3 ‚Ä¢ 1 point each)</div>
                        
                        <div class="matchup">
                            <label for="game1">#1 Minnesota Lynx vs #8 Golden State Valkyries</label>
                            <select id="game1" name="game1" required>
                                <option value="">Select Winner</option>
                                <option value="Minnesota Lynx">Minnesota Lynx</option>
                                <option value="Golden State Valkyries">Golden State Valkyries</option>
                            </select>
                        </div>
                        
                        <div class="matchup">
                            <label for="game2">#4 Phoenix Mercury vs #5 New York Liberty</label>
                            <select id="game2" name="game2" required>
                                <option value="">Select Winner</option>
                                <option value="Phoenix Mercury">Phoenix Mercury</option>
                                <option value="New York Liberty">New York Liberty</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Right Side First Round -->
                    <div class="round-section">
                        <div class="round-title">FIRST ROUND - RIGHT SIDE<br>(Best of 3 ‚Ä¢ 1 point each)</div>
                        
                        <div class="matchup">
                            <label for="game3">#2 Las Vegas Aces vs #7 Seattle Storm</label>
                            <select id="game3" name="game3" required>
                                <option value="">Select Winner</option>
                                <option value="Las Vegas Aces">Las Vegas Aces</option>
                                <option value="Seattle Storm">Seattle Storm</option>
                            </select>
                        </div>
                        
                        <div class="matchup">
                            <label for="game4">#3 Atlanta Dream vs #6 Indiana Fever</label>
                            <select id="game4" name="game4" required>
                                <option value="">Select Winner</option>
                                <option value="Atlanta Dream">Atlanta Dream</option>
                                <option value="Indiana Fever">Indiana Fever</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="bracket-section">
                    <!-- Left Semifinal -->
                    <div class="round-section">
                        <div class="round-title">SEMIFINAL 1<br>(Best of 5 ‚Ä¢ 2 points)</div>
                        
                        <div class="matchup">
                            <label for="semi1">Winner of (Lynx/Valkyries) vs Winner of (Mercury/Liberty)</label>
                            <select id="semi1" name="semi1" required>
                                <option value="">Select Winner</option>
                                <option value="Minnesota Lynx">Minnesota Lynx</option>
                                <option value="Golden State Valkyries">Golden State Valkyries</option>
                                <option value="Phoenix Mercury">Phoenix Mercury</option>
                                <option value="New York Liberty">New York Liberty</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Right Semifinal -->
                    <div class="round-section">
                        <div class="round-title">SEMIFINAL 2<br>(Best of 5 ‚Ä¢ 2 points)</div>
                        
                        <div class="matchup">
                            <label for="semi2">Winner of (Aces/Storm) vs Winner of (Dream/Fever)</label>
                            <select id="semi2" name="semi2" required>
                                <option value="">Select Winner</option>
                                <option value="Las Vegas Aces">Las Vegas Aces</option>
                                <option value="Seattle Storm">Seattle Storm</option>
                                <option value="Atlanta Dream">Atlanta Dream</option>
                                <option value="Indiana Fever">Indiana Fever</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Finals -->
                <div class="finals-section round-section">
                    <div class="round-title">üèÜ WNBA FINALS üèÜ<br>(Best of 5 ‚Ä¢ 4 points)</div>
                    
                    <div class="matchup">
                        <label for="finals">2025 WNBA Champion</label>
                        <select id="finals" name="finals" required>
                            <option value="">Select Champion</option>
                            <option value="Minnesota Lynx">Minnesota Lynx</option>
                            <option value="Golden State Valkyries">Golden State Valkyries</option>
                            <option value="Phoenix Mercury">Phoenix Mercury</option>
                            <option value="New York Liberty">New York Liberty</option>
                            <option value="Las Vegas Aces">Las Vegas Aces</option>
                            <option value="Seattle Storm">Seattle Storm</option>
                            <option value="Atlanta Dream">Atlanta Dream</option>
                            <option value="Indiana Fever">Indiana Fever</option>
                        </select>
                    </div>
                </div>
                
                <div class="submit-section">
<button type="submit" class="submit-btn" id="submitBtn">
                    üèÄ Submit My Bracket Picks üèÄ
</button>
                </div>
            </form>
            
            <div id="resultsDisplay" class="results-display">
                <div id="loadingSpinner" class="loading">
                    <p>üèÄ Submitting your picks to Google Sheets...</p>
                </div>
                <div id="summaryText"></div>
            </div>
        </div>

        <!-- DASHBOARD TAB -->
        <div id="dashboard" class="tab-content">
            <h2>üìä Office Pool Dashboard</h2>
            <p>Track everyone's picks and scores in real-time</p>
            
            <button class="refresh-btn" onclick="loadDashboard()">üîÑ Refresh Data</button>
            
            <div id="dashboardLoading" class="loading">Loading dashboard data...</div>
            <div id="dashboardContent">
                <table class="dashboard-table" id="dashboardTable">
                    <thead>
                        <tr>
                            <th>Participant</th>
                            <th>Current Score</th>
                            <th>Champion Pick</th>
                            <th>Submitted</th>
                        </tr>
                    </thead>
                    <tbody id="dashboardTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ADMIN TAB -->
        <div id="admin" class="tab-content">
            <h2>‚öôÔ∏è Admin Panel</h2>
            
            <div class="admin-section">
                <h3>Google Sheets Setup</h3>
                <p>To enable data saving, you need to set up a Google Apps Script Web App:</p>
                
                <ol style="line-height: 1.8; margin: 15px 0;">
                    <li>Go to <a href="https://script.google.com" target="_blank" style="color: #ff6b35;">script.google.com</a></li>
                    <li>Create a new project</li>
                    <li>Paste the provided Apps Script code</li>
                    <li>Deploy as a Web App</li>
                    <li>Copy the Web App URL and paste it below</li>
                </ol>
                
                <div style="margin: 20px 0;">
                    <label for="webAppUrl"><strong>Google Apps Script Web App URL:</strong></label>
                    <input type="url" id="webAppUrl" placeholder="https://script.google.com/macros/s/YOUR_ID/exec" 
                           style="width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc;">
                    <button onclick="saveWebAppUrl()" style="margin-top: 10px; padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">Save URL</button>
                </div>
                
                <div id="urlStatus" class="status-message" style="display: none;"></div>
            </div>
            
            <div class="admin-section">
                <h3>Apps Script Code</h3>
                <p>Copy and paste this code into your Google Apps Script:</p>
                <textarea readonly style="width: 100%; height: 300px; background: #222; color: #0f0; padding: 15px; border-radius: 5px; font-family: monospace; margin-top: 10px;">function doPost(e) {
  const sheet = SpreadsheetApp.openById('YOUR_SHEET_ID').getActiveSheet();
  const data = JSON.parse(e.postData.contents);
  
  // Add headers if sheet is empty
  if (sheet.getLastRow() === 0) {
    sheet.getRange(1, 1, 1, 10).setValues([['Name', 'Game1', 'Game2', 'Game3', 'Game4', 'Semi1', 'Semi2', 'Finals', 'Timestamp', 'Score']]);
  }
  
  // Add new submission
  sheet.appendRow([
    data.participantName,
    data.game1,
    data.game2, 
    data.game3,
    data.game4,
    data.semi1,
    data.semi2,
    data.finals,
    new Date(),
    0 // Initial score
  ]);
  
  return ContentService.createTextOutput('Success');
}

function doGet() {
  const sheet = SpreadsheetApp.openById('YOUR_SHEET_ID').getActiveSheet();
  const data = sheet.getDataRange().getValues();
  return ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON);
}</textarea>
            </div>
        </div>
    </div>

<script>
// === WNBA Bracket ‚Äî Single Script Replacement ===
// 1) Your deployed Apps Script Web App URL:
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzzJaF9QyHbDwpEG5pcxhryQxs2gXuDKNV7c4aR8PDORuWmT3nX4HNrPXupUd-IXW8QSQ/exec';

// 2) Utility: safe element getter
function $(sel) { return document.querySelector(sel); }
function showTab(tabName) {
    console.log('showTab called with:', tabName);
    // Hide all tabs
    const contents = document.querySelectorAll('.tab-content');
    contents.forEach(content => content.classList.remove('active'));
    
    const tabs = document.querySelectorAll('.nav-tab');
    tabs.forEach(tab => tab.classList.remove('active'));
    
    // Show selected tab
    document.getElementById(tabName).classList.add('active');
    event.target.classList.add('active');
    
    // Load dashboard when clicked
    if (tabName === 'dashboard') {
        loadDashboard();
    }
}
function loadDashboard() {
   console.log('loadDashboard starting...');
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbzzJaF9QyHbDwpEG5pcxhryQxs2gXuDKNV7c4aR8PDORuWmT3nX4HNrPXupUd-IXW8QSQ/exec';

  document.getElementById('dashboardTableBody').innerHTML = '<p>Loading submissions...</p>';
  console.log('About to fetch from:', webAppUrl);  
    fetch(webAppUrl)
        .then(response => response.json())
        .then(data => {
          console.log('Data received:', data);
            if (!data || data.length <= 1) {
     document.getElementById('dashboardTableBody').innerHTML = '<p>No submissions yet.</p>';
                return;
            }
     
          let html = '';
console.log('About to process', data.length, 'rows');
data.forEach((row, index) => {
    console.log('Processing row', index, row);
    html += '<tr>'
        +'<td>' + (row.name || 'No name') + '</td>'
  + '<td>' + (row.score || 0) + '</td>'
        +'<td>' + (row.champion || 'No champion') + '</td>'
        +'<td>Submitted</td>'
    +'</tr>';
    console.log('HTML after row', index, html.length, 'characters');
});
console.log('Final HTML length:', html.length);
            
        document.getElementById('dashboardTableBody').innerHTML = html;
        })
        .catch(error => {
        document.getElementById('dashboardTableBody').innerHTML = '<p>Error loading data.</p>';
        });
}
// 3) Smart dropdown helpers
function setOptions(selectId, teams) {
  const sel = $('#' + selectId);
  if (!sel) return;
  const current = sel.value;
  sel.innerHTML = '<option value="">Select Winner</option>' +
    teams.map(t => `<option value="${t}">${t}</option>`).join('');
  if (teams.includes(current)) sel.value = current;
}

function updateSemis() {
  const g1 = ($('#game1') || {}).value || '';
  const g2 = ($('#game2') || {}).value || '';
  const g3 = ($('#game3') || {}).value || '';
  const g4 = ($('#game4') || {}).value || '';
  setOptions('semi1', [g1, g2].filter(Boolean));
  setOptions('semi2', [g3, g4].filter(Boolean));
  updateFinals();
}

function updateFinals() {
  const s1 = ($('#semi1') || {}).value || '';
  const s2 = ($('#semi2') || {}).value || '';
  setOptions('finals', [s1, s2].filter(Boolean));
}

// 4) Build payload from form
function buildPicks() {
  return {
    participantName: ($('#participantName') || {}).value?.trim() || '',
    game1: ($('#game1') || {}).value || '',
    game2: ($('#game2') || {}).value || '',
    game3: ($('#game3') || {}).value || '',
    game4: ($('#game4') || {}).value || '',
    semi1: ($('#semi1') || {}).value || '',
    semi2: ($('#semi2') || {}).value || '',
    finals: ($('#finals') || {}).value || ''
  };
}

// 5) Submit to Google Sheets via Apps Script
async function submitBracket(e) {
  // Works whether called by form submit or button click
  if (e && typeof e.preventDefault === 'function') e.preventDefault();

  // Basic guard rails
  const name = ($('#participantName') || {}).value?.trim();
  if (!name) {
    alert('Please enter your name before submitting.');
    ($('#participantName') || {}).focus?.();
    return;
  }

  // Make sure finals has a value (best effort)
  const finalsSel = $('#finals');
  if (!finalsSel || !finalsSel.value) {
    // Try to update finals in case semis just changed
    updateFinals();
  }

  const picks = buildPicks();

  try {
    const response = await fetch(WEB_APP_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain;charset=utf-8' },
      body: JSON.stringify(picks)
    });

  alert('Thanks! Your bracket has been submitted successfully. Check the Dashboard to see everyone\'s picks!');

    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }

    // Optional: clear the form after success
    // (uncomment if you want)
    // (document.querySelector('form') || {}).reset?.();
    // updateSemis(); // refresh dependent dropdowns
  } catch (err) {
    alert('Submission failed. Please try again.\n\n' + String(err));
    console.error(err);
  }
}

// 6) Wire up events once DOM is ready
document.addEventListener('DOMContentLoaded', () => {
  // Wire change listeners for smart dropdowns
  ['#game1','#game2','#game3','#game4'].forEach(id => {
    const el = $(id);
    if (el) el.addEventListener('change', updateSemis);
  });
  ['#semi1','#semi2'].forEach(id => {
    const el = $(id);
    if (el) el.addEventListener('change', updateFinals);
  });

  // Initialize options on load
  updateSemis();

  // Hook up submit
  // Prefer form submit if there is a <form id="bracketForm">; otherwise bind the button.
  const form = $('#bracketForm') || $('form');
  const btn = $('#submitBtn'); // your actual button id from the markup

  if (form) {
    form.addEventListener('submit', submitBracket);
  }
  if (btn) {
    // Also bind click in case the button lives outside the form or the form prevents submit
    btn.addEventListener('click', submitBracket);
  }

  // Remove any leftover admin/localStorage wiring by noop-ing known functions/vars safely
  // (prevents errors if the HTML still references them)
  window.saveWebAppUrl = function() {};
});

// === End single script replacement ===
</script>

</body>
</html>
